# 📱 回覆鍵盤（Reply Keyboard）完整指南

## 什麼是回覆鍵盤？

回覆鍵盤是顯示在 Telegram 輸入框下方的永久按鈕，用戶可以直接點擊按鈕來訪問功能，無需輸入命令。

## 菜單結構

### 一級菜單（主菜單）

對應 miniapp 的底部導航：

```
┌─────────────┬─────────────┐
│  💰 錢包    │  🧧 紅包     │
├─────────────┼─────────────┤
│  📈 賺取    │  🎮 遊戲     │
├─────────────┴─────────────┤
│  👤 我的    │  📱 打開應用  │
└─────────────────────────────┘
```

### 二級菜單

#### 錢包菜單
```
┌─────────────┬─────────────┐
│  💵 充值    │  💸 提現     │
├─────────────┼─────────────┤
│  📜 交易記錄 │  🔄 兌換     │
├─────────────┴─────────────┤
│      ◀️ 返回主菜單          │
└─────────────────────────────┘
```

#### 紅包菜單
```
┌─────────────┬─────────────┐
│  📋 查看紅包 │  ➕ 發紅包   │
├─────────────┴─────────────┤
│      🎁 我的紅包           │
├─────────────────────────────┤
│      ◀️ 返回主菜單          │
└─────────────────────────────┘
```

#### 賺取菜單
```
┌─────────────┬─────────────┐
│  📅 每日簽到 │  👥 邀請好友 │
├─────────────┼─────────────┤
│  🎯 任務中心 │  🎰 幸運轉盤 │
├─────────────┴─────────────┤
│      ◀️ 返回主菜單          │
└─────────────────────────────┘
```

#### 遊戲菜單
```
┌─────────────┬─────────────┐
│  🎰 金運局   │  🎡 幸運轉盤 │
├─────────────┴─────────────┤
│      ◀️ 返回主菜單          │
└─────────────────────────────┘
```

#### 個人資料菜單
```
┌─────────────┬─────────────┐
│  📊 我的資料  │  📈 統計數據 │
├─────────────┴─────────────┤
│      ⚙️ 設置               │
├─────────────────────────────┤
│      ◀️ 返回主菜單          │
└─────────────────────────────┘
```

### 三級菜單

#### 兌換菜單
```
┌─────────────┬─────────────┐
│  USDT → TON │  TON → USDT │
├─────────────┼─────────────┤
│  USDT → 能量 │  能量 → USDT │
├─────────────┼─────────────┤
│  TON → 能量  │  能量 → TON  │
├─────────────┴─────────────┤
│      ◀️ 返回錢包           │
└─────────────────────────────┘
```

#### 充值/提現菜單
```
┌─────────────┬─────────────┐
│  💵 充值 USDT│ 💵 充值 TON │
├─────────────┴─────────────┤
│      ◀️ 返回錢包           │
└─────────────────────────────┘
```

## 功能對應表

### 一級菜單功能

| 按鈕 | 功能 | 對應 miniapp 頁面 |
|------|------|------------------|
| 💰 錢包 | 錢包管理 | `/` (WalletPage) |
| 🧧 紅包 | 紅包功能 | `/packets` (PacketsPage) |
| 📈 賺取 | 賺取中心 | `/earn` (EarnPage) |
| 🎮 遊戲 | 遊戲中心 | `/game` (GamePage) |
| 👤 我的 | 個人資料 | `/profile` (ProfilePage) |
| 📱 打開應用 | 打開 miniapp | Web App |

### 二級菜單功能

#### 錢包
- 💵 充值 → 充值頁面 (`/recharge`)
- 💸 提現 → 提現頁面 (`/withdraw`)
- 📜 交易記錄 → 查看交易歷史
- 🔄 兌換 → 兌換頁面 (`/exchange`)

#### 紅包
- 📋 查看紅包 → 查看可搶紅包列表
- ➕ 發紅包 → 發送紅包流程 (`/send`)
- 🎁 我的紅包 → 查看我發送的紅包

#### 賺取
- 📅 每日簽到 → 每日簽到功能
- 👥 邀請好友 → 邀請功能
- 🎯 任務中心 → 任務列表
- 🎰 幸運轉盤 → 幸運轉盤遊戲 (`/lucky-wheel`)

#### 遊戲
- 🎰 金運局 → 外部遊戲介紹
- 🎡 幸運轉盤 → 幸運轉盤 (`/lucky-wheel`)

#### 個人資料
- 📊 我的資料 → 個人信息
- 📈 統計數據 → 統計信息
- ⚙️ 設置 → 設置頁面

### 三級菜單功能

#### 兌換
- USDT → TON
- TON → USDT
- USDT → 能量
- 能量 → USDT
- TON → 能量
- 能量 → TON

## 使用方式

### 用戶使用

1. **發送 `/start`** - 顯示主菜單和回覆鍵盤
2. **點擊按鈕** - 直接訪問對應功能
3. **使用返回按鈕** - 返回上一級菜單

### 開發者

回覆鍵盤會自動：
- 在 `/start` 時顯示主菜單
- 根據用戶點擊的按鈕切換到對應的菜單
- 處理多級菜單導航

## 技術實現

### 文件結構

- `bot/keyboards/reply_keyboards.py` - 回覆鍵盤定義
- `bot/handlers/keyboard.py` - 回覆鍵盤處理器
- `bot/utils/query_helper.py` - 輔助函數

### 處理流程

1. 用戶點擊回覆鍵盤按鈕
2. `keyboard.handle_reply_keyboard` 處理按鈕點擊
3. 調用對應的處理函數
4. 更新回覆鍵盤為對應的子菜單

## 優勢

1. **直觀** - 按鈕清晰顯示所有功能
2. **快速** - 無需輸入命令，一鍵訪問
3. **完整** - 對應 miniapp 的所有功能
4. **多級** - 支持一級、二級、三級菜單
5. **一致** - 與 miniapp 功能完全對應

## 注意事項

1. **回覆鍵盤會一直顯示** - 直到用戶發送 `/start` 或使用返回按鈕
2. **與內聯鍵盤共存** - 回覆鍵盤在輸入框下方，內聯鍵盤在消息下方
3. **優先級** - 回覆鍵盤按鈕優先於文本輸入處理

## 更新記錄

- ✅ 創建完整的多級回覆鍵盤系統
- ✅ 對應 miniapp 的所有主要功能
- ✅ 支持一級、二級、三級菜單導航
- ✅ 與現有內聯鍵盤系統兼容
