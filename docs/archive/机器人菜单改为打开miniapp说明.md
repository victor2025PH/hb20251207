# æœºå™¨äººèœå•æ”¹ä¸ºæ‰“å¼€ miniapp è¯´æ˜

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. æ‰€æœ‰å†…è”é”®ç›˜æŒ‰é’®æ”¹ä¸ºæ‰“å¼€ miniapp
- âœ… ä¸»èœå•æŒ‰é’®ï¼ˆğŸ’° éŒ¢åŒ…ã€ğŸ§§ ç´…åŒ…ã€ğŸ“ˆ è³ºå–ã€ğŸ® éŠæˆ²ã€ğŸ‘¤ æˆ‘çš„ï¼‰
- âœ… é’±åŒ…å­èœå•æŒ‰é’®ï¼ˆğŸ’µ å……å€¼ã€ğŸ’¸ æç¾ã€ğŸ“œ äº¤æ˜“è¨˜éŒ„ã€ğŸ”„ å…Œæ›ï¼‰
- âœ… çº¢åŒ…å­èœå•æŒ‰é’®ï¼ˆğŸ“‹ æŸ¥çœ‹ç´…åŒ…ã€â• ç™¼ç´…åŒ…ã€ğŸ æˆ‘çš„ç´…åŒ…ï¼‰
- âœ… èµšå–å­èœå•æŒ‰é’®ï¼ˆğŸ“… æ¯æ—¥ç°½åˆ°ã€ğŸ‘¥ é‚€è«‹å¥½å‹ã€ğŸ¯ ä»»å‹™ä¸­å¿ƒã€ğŸ° å¹¸é‹è½‰ç›¤ï¼‰
- âœ… ä¸ªäººèµ„æ–™å­èœå•æŒ‰é’®ï¼ˆğŸ“Š æˆ‘çš„è³‡æ–™ã€ğŸ“ˆ çµ±è¨ˆæ•¸æ“šã€âš™ï¸ è¨­ç½®ï¼‰
- âœ… å…‘æ¢å­èœå•æŒ‰é’®ï¼ˆæ‰€æœ‰å…‘æ¢ç±»å‹ï¼‰

### 2. æ‰€æœ‰å›è¦†é”®ç›˜æŒ‰é’®æ”¹ä¸ºæ‰“å¼€ miniapp
- âœ… ä¸»å›è¦†é”®ç›˜æŒ‰é’®ï¼ˆåº•éƒ¨é”®ç›˜ï¼‰
- âœ… æ‰€æœ‰å­èœå•å›è¦†é”®ç›˜æŒ‰é’®

### 3. æ·»åŠ äº†æ–°å‘½ä»¤åˆ°èŠå¤©æ 
- âœ… `/wallet` - æ‰“é–‹éŒ¢åŒ…
- âœ… `/packets` - æ‰“é–‹ç´…åŒ…
- âœ… `/earn` - æ‰“é–‹è³ºå–
- âœ… `/game` - æ‰“é–‹éŠæˆ²
- âœ… `/profile` - æ‰“é–‹æˆ‘çš„

### 4. æ›´æ–°äº†å¸®åŠ©å‘½ä»¤
- âœ… `/help` å‘½ä»¤ç°åœ¨åŒ…å«æ‰€æœ‰æ–°å‘½ä»¤

---

## ğŸ“ éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆå…± 4 ä¸ªï¼‰

### æœåŠ¡å™¨è·¯å¾„ï¼š`/opt/luckyred/`

1. **bot/keyboards/__init__.py**
   - æœ¬åœ°è·¯å¾„ï¼š`C:\hbgm001\bot\keyboards\__init__.py`
   - æœåŠ¡å™¨è·¯å¾„ï¼š`/opt/luckyred/bot/keyboards/__init__.py`

2. **bot/keyboards/reply_keyboards.py**
   - æœ¬åœ°è·¯å¾„ï¼š`C:\hbgm001\bot\keyboards\reply_keyboards.py`
   - æœåŠ¡å™¨è·¯å¾„ï¼š`/opt/luckyred/bot/keyboards/reply_keyboards.py`

3. **bot/main.py**
   - æœ¬åœ°è·¯å¾„ï¼š`C:\hbgm001\bot\main.py`
   - æœåŠ¡å™¨è·¯å¾„ï¼š`/opt/luckyred/bot/main.py`

4. **bot/handlers/start.py**
   - æœ¬åœ°è·¯å¾„ï¼š`C:\hbgm001\bot\handlers\start.py`
   - æœåŠ¡å™¨è·¯å¾„ï¼š`/opt/luckyred/bot/handlers/start.py`

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹æ³• 1: ä½¿ç”¨ WinSCP ä¸Šä¼ 

1. è¿æ¥åˆ°æœåŠ¡å™¨ï¼š
   - ä¸»æœºåï¼š`165.154.254.99`
   - ç”¨æˆ·åï¼š`ubuntu`
   - å¯†ç ï¼šæ‚¨çš„æœåŠ¡å™¨å¯†ç 

2. ä¸Šä¼ æ–‡ä»¶åˆ°å¯¹åº”ç›®å½•ï¼š
   - `bot/keyboards/__init__.py` â†’ `/opt/luckyred/bot/keyboards/__init__.py`
   - `bot/keyboards/reply_keyboards.py` â†’ `/opt/luckyred/bot/keyboards/reply_keyboards.py`
   - `bot/main.py` â†’ `/opt/luckyred/bot/main.py`
   - `bot/handlers/start.py` â†’ `/opt/luckyred/bot/handlers/start.py`

3. SSH è¿æ¥åˆ°æœåŠ¡å™¨å¹¶é‡å¯ botï¼š
   ```bash
   ssh ubuntu@165.154.254.99
   sudo systemctl restart luckyred-bot
   sudo systemctl status luckyred-bot
   ```

### æ–¹æ³• 2: ä½¿ç”¨ SCP ä¸Šä¼ 

```powershell
# åœ¨ PowerShell ä¸­æ‰§è¡Œ
scp C:\hbgm001\bot\keyboards\__init__.py ubuntu@165.154.254.99:/opt/luckyred/bot/keyboards/__init__.py
scp C:\hbgm001\bot\keyboards\reply_keyboards.py ubuntu@165.154.254.99:/opt/luckyred/bot/keyboards/reply_keyboards.py
scp C:\hbgm001\bot\main.py ubuntu@165.154.254.99:/opt/luckyred/bot/main.py
scp C:\hbgm001\bot\handlers\start.py ubuntu@165.154.254.99:/opt/luckyred/bot/handlers/start.py

# ç„¶å SSH è¿æ¥å¹¶é‡å¯
ssh ubuntu@165.154.254.99 "sudo systemctl restart luckyred-bot"
```

---

## âœ… éªŒè¯æ­¥éª¤

ä¸Šä¼ å¹¶é‡å¯åï¼Œè¯·æµ‹è¯•ï¼š

### 1. æµ‹è¯•å†…è”é”®ç›˜æŒ‰é’®ï¼ˆæ¶ˆæ¯ä¸­çš„ç»¿è‰²æŒ‰é’®ï¼‰
- ç‚¹å‡» "ğŸ’° éŒ¢åŒ…" æŒ‰é’® â†’ åº”è¯¥æ‰“å¼€ miniapp é’±åŒ…é¡µé¢
- ç‚¹å‡» "ğŸ§§ ç´…åŒ…" æŒ‰é’® â†’ åº”è¯¥æ‰“å¼€ miniapp çº¢åŒ…é¡µé¢
- ç‚¹å‡» "ğŸ“ˆ è³ºå–" æŒ‰é’® â†’ åº”è¯¥æ‰“å¼€ miniapp èµšå–é¡µé¢
- ç‚¹å‡» "ğŸ® éŠæˆ²" æŒ‰é’® â†’ åº”è¯¥æ‰“å¼€ miniapp æ¸¸æˆé¡µé¢
- ç‚¹å‡» "ğŸ‘¤ æˆ‘çš„" æŒ‰é’® â†’ åº”è¯¥æ‰“å¼€ miniapp ä¸ªäººèµ„æ–™é¡µé¢

### 2. æµ‹è¯•å›è¦†é”®ç›˜æŒ‰é’®ï¼ˆåº•éƒ¨é”®ç›˜ï¼‰
- ç‚¹å‡» "ğŸ’° éŒ¢åŒ…" æŒ‰é’® â†’ åº”è¯¥ç›´æ¥æ‰“å¼€ miniapp é’±åŒ…é¡µé¢
- ç‚¹å‡» "ğŸ§§ ç´…åŒ…" æŒ‰é’® â†’ åº”è¯¥ç›´æ¥æ‰“å¼€ miniapp çº¢åŒ…é¡µé¢
- ç‚¹å‡» "ğŸ“ˆ è³ºå–" æŒ‰é’® â†’ åº”è¯¥ç›´æ¥æ‰“å¼€ miniapp èµšå–é¡µé¢
- ç‚¹å‡» "ğŸ® éŠæˆ²" æŒ‰é’® â†’ åº”è¯¥ç›´æ¥æ‰“å¼€ miniapp æ¸¸æˆé¡µé¢
- ç‚¹å‡» "ğŸ‘¤ æˆ‘çš„" æŒ‰é’® â†’ åº”è¯¥ç›´æ¥æ‰“å¼€ miniapp ä¸ªäººèµ„æ–™é¡µé¢
- ç‚¹å‡» "ğŸ“± æ‰“é–‹æ‡‰ç”¨" æŒ‰é’® â†’ åº”è¯¥æ‰“å¼€ miniapp ä¸»é¡µ

### 3. æµ‹è¯•å‘½ä»¤ï¼ˆåœ¨èŠå¤©æ è¾“å…¥ï¼‰
- è¾“å…¥ `/wallet` â†’ åº”è¯¥æ˜¾ç¤ºæŒ‰é’®ï¼Œç‚¹å‡»åæ‰“å¼€é’±åŒ…é¡µé¢
- è¾“å…¥ `/packets` â†’ åº”è¯¥æ˜¾ç¤ºæŒ‰é’®ï¼Œç‚¹å‡»åæ‰“å¼€çº¢åŒ…é¡µé¢
- è¾“å…¥ `/earn` â†’ åº”è¯¥æ˜¾ç¤ºæŒ‰é’®ï¼Œç‚¹å‡»åæ‰“å¼€èµšå–é¡µé¢
- è¾“å…¥ `/game` â†’ åº”è¯¥æ˜¾ç¤ºæŒ‰é’®ï¼Œç‚¹å‡»åæ‰“å¼€æ¸¸æˆé¡µé¢
- è¾“å…¥ `/profile` â†’ åº”è¯¥æ˜¾ç¤ºæŒ‰é’®ï¼Œç‚¹å‡»åæ‰“å¼€ä¸ªäººèµ„æ–™é¡µé¢
- è¾“å…¥ `/help` â†’ åº”è¯¥æ˜¾ç¤ºåŒ…å«æ‰€æœ‰å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯

### 4. æµ‹è¯•å­èœå•æŒ‰é’®
- è¿›å…¥é’±åŒ…èœå•åï¼Œç‚¹å‡» "ğŸ’µ å……å€¼" â†’ åº”è¯¥æ‰“å¼€ miniapp å……å€¼é¡µé¢
- è¿›å…¥é’±åŒ…èœå•åï¼Œç‚¹å‡» "ğŸ’¸ æç¾" â†’ åº”è¯¥æ‰“å¼€ miniapp æç°é¡µé¢
- è¿›å…¥çº¢åŒ…èœå•åï¼Œç‚¹å‡» "â• ç™¼ç´…åŒ…" â†’ åº”è¯¥æ‰“å¼€ miniapp å‘çº¢åŒ…é¡µé¢

---

## ğŸ“ ä¿®æ”¹è¯¦æƒ…

### å†…è”é”®ç›˜æŒ‰é’®ï¼ˆInline Keyboardï¼‰
æ‰€æœ‰æŒ‰é’®ä» `callback_data` æ”¹ä¸º `web_app=WebAppInfo(url=...)`ï¼š
- ä¸»èœå•ï¼š`/wallet`, `/packets`, `/earn`, `/game`, `/profile`
- å­èœå•ï¼šå¯¹åº”ä¸åŒçš„ miniapp é¡µé¢è·¯å¾„

### å›è¦†é”®ç›˜æŒ‰é’®ï¼ˆReply Keyboardï¼‰
æ‰€æœ‰æŒ‰é’®ä»æ™®é€šæ–‡æœ¬æŒ‰é’®æ”¹ä¸º `web_app=WebAppInfo(url=...)`ï¼š
- ä¸»èœå•æŒ‰é’®ç›´æ¥æ‰“å¼€å¯¹åº”çš„ miniapp é¡µé¢
- å­èœå•æŒ‰é’®ä¹Ÿç›´æ¥æ‰“å¼€å¯¹åº”çš„ miniapp é¡µé¢

### å‘½ä»¤å¤„ç†
- æ·»åŠ äº† `open_miniapp_command` å‡½æ•°å¤„ç†æ‰€æœ‰æ‰“å¼€ miniapp çš„å‘½ä»¤
- åœ¨ `setup_commands` ä¸­æ·»åŠ äº†æ–°å‘½ä»¤
- æ›´æ–°äº† `help_command` ä»¥åŒ…å«æ‰€æœ‰æ–°å‘½ä»¤

---

## ğŸ” å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

å¦‚æœä¸Šä¼ åé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æ£€æŸ¥ï¼š

1. **Bot æ˜¯å¦æ­£å¸¸è¿è¡Œ**ï¼š
   ```bash
   sudo systemctl status luckyred-bot
   ```

2. **æŸ¥çœ‹ Bot æ—¥å¿—**ï¼š
   ```bash
   sudo journalctl -u luckyred-bot -n 100 --no-pager
   ```

3. **ç¡®è®¤æ–‡ä»¶å·²æ­£ç¡®ä¸Šä¼ **ï¼š
   ```bash
   ls -lh /opt/luckyred/bot/keyboards/__init__.py
   ls -lh /opt/luckyred/bot/keyboards/reply_keyboards.py
   ls -lh /opt/luckyred/bot/main.py
   ls -lh /opt/luckyred/bot/handlers/start.py
   ```

4. **æ£€æŸ¥ miniapp URL é…ç½®**ï¼š
   ```bash
   grep MINIAPP_URL /opt/luckyred/.env
   ```

---

**éƒ¨ç½²å®Œæˆåï¼Œæ‰€æœ‰èœå•æŒ‰é’®å’Œå‘½ä»¤éƒ½ä¼šæ‰“å¼€å¯¹åº”çš„ miniapp é¡µé¢ï¼**
