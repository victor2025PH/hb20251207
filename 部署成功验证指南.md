# âœ… éƒ¨ç½²æˆåŠŸéªŒè¯æŒ‡å—

## ğŸ‰ éƒ¨ç½²çŠ¶æ€

æ ¹æ®éƒ¨ç½²æ—¥å¿—ï¼Œéƒ¨ç½²å·²æˆåŠŸå®Œæˆï¼š
- âœ… Git pull æˆåŠŸ
- âœ… API ä¾èµ–å®‰è£…æˆåŠŸ
- âœ… Bot ä¾èµ–å®‰è£…æˆåŠŸ
- âœ… å‰ç«¯æ„å»ºæˆåŠŸï¼ˆ1848 ä¸ªæ¨¡å—ï¼Œ8.37 ç§’ï¼‰
- âœ… æ‰€æœ‰æ–‡ä»¶å·²ç”Ÿæˆåˆ° `dist/` ç›®å½•

---

## ğŸ”§ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. æ‰‹åŠ¨é‡å¯æœåŠ¡ï¼ˆéœ€è¦ root æƒé™ï¼‰

ç”±äºå½“å‰ç”¨æˆ·æ²¡æœ‰ root æƒé™ï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# é‡å¯ API æœåŠ¡
sudo systemctl restart luckyred-api

# é‡å¯ Bot æœåŠ¡
sudo systemctl restart luckyred-bot

# é‡æ–°åŠ è½½ Nginx
sudo systemctl reload nginx
```

### 2. éªŒè¯æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
sudo systemctl status luckyred-api
sudo systemctl status luckyred-bot
sudo systemctl status nginx
```

**é¢„æœŸç»“æœ**ï¼š
- æ‰€æœ‰æœåŠ¡åº”è¯¥æ˜¾ç¤º `active (running)`
- æ²¡æœ‰é”™è¯¯ä¿¡æ¯

### 3. å¥åº·æ£€æŸ¥

```bash
# åŸºç¡€å¥åº·æ£€æŸ¥
curl http://localhost:8080/health

# è¯¦ç»†å¥åº·æ£€æŸ¥
curl http://localhost:8080/health/detailed

# ç³»ç»ŸæŒ‡æ ‡
curl http://localhost:8080/health/metrics
```

**é¢„æœŸå“åº”**ï¼š
```json
{
  "status": "healthy",
  "timestamp": "2025-12-06T...",
  "service": "luckyred-api",
  "version": "1.0.0"
}
```

### 4. å‰ç«¯è®¿é—®æµ‹è¯•

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
- MiniApp: `https://mini.usdt2026.cc`
- æ£€æŸ¥é¡µé¢æ˜¯å¦æ­£å¸¸åŠ è½½
- æ£€æŸ¥ä¸»è¦åŠŸèƒ½æ˜¯å¦å¯ç”¨

---

## ğŸ“Š åŠŸèƒ½éªŒè¯æ¸…å•

### åŸºç¡€åŠŸèƒ½
- [ ] é¡µé¢å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] ç™»å½•åŠŸèƒ½æ­£å¸¸ï¼ˆTelegram/Webï¼‰
- [ ] å¯¼èˆªæ æ­£å¸¸æ˜¾ç¤º

### æ ¸å¿ƒåŠŸèƒ½
- [ ] å‘é€çº¢åŒ…åŠŸèƒ½
- [ ] é¢†å–çº¢åŒ…åŠŸèƒ½
- [ ] é’±åŒ…ä½™é¢æ˜¾ç¤º
- [ ] å……å€¼åŠŸèƒ½ï¼ˆé iOSï¼‰
- [ ] æç°åŠŸèƒ½ï¼ˆé iOSï¼‰
- [ ] å…‘æ¢åŠŸèƒ½ï¼ˆé iOSï¼‰

### å…¶ä»–åŠŸèƒ½
- [ ] æ¯æ—¥ç­¾åˆ°
- [ ] é‚€è¯·å¥½å‹
- [ ] æ¨èç³»ç»Ÿ
- [ ] ä»»åŠ¡ç³»ç»Ÿ
- [ ] ç”¨æˆ·åé¦ˆï¼ˆä¸ªäººé¡µé¢ï¼‰

### åˆè§„UI
- [ ] iOS è®¾å¤‡éšè—é‡‘èåŠŸèƒ½
- [ ] æ˜¾ç¤ºåˆè§„æç¤ºä¿¡æ¯

---

## ğŸ” æŸ¥çœ‹æ—¥å¿—

### API æ—¥å¿—
```bash
# å®æ—¶æŸ¥çœ‹ API æ—¥å¿—
sudo journalctl -u luckyred-api -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
sudo journalctl -u luckyred-api -n 100

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo journalctl -u luckyred-api | grep -i error
```

### Bot æ—¥å¿—
```bash
# å®æ—¶æŸ¥çœ‹ Bot æ—¥å¿—
sudo journalctl -u luckyred-bot -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
sudo journalctl -u luckyred-bot -n 100
```

### Nginx æ—¥å¿—
```bash
# è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log

# é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

---

## âš ï¸ å¦‚æœé‡åˆ°é—®é¢˜

### æœåŠ¡æ— æ³•å¯åŠ¨

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
sudo journalctl -u luckyred-api -n 50

# æ£€æŸ¥é…ç½®æ–‡ä»¶
python3 -c "from shared.config.settings import get_settings; print(get_settings())"
```

### å‰ç«¯æ— æ³•è®¿é—®

```bash
# æ£€æŸ¥å‰ç«¯æ–‡ä»¶
ls -la /opt/luckyred/frontend/dist/

# æ£€æŸ¥ Nginx é…ç½®
sudo nginx -t

# æ£€æŸ¥æ–‡ä»¶æƒé™
sudo chown -R www-data:www-data /opt/luckyred/frontend/dist
```

### å¥åº·æ£€æŸ¥å¤±è´¥

```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
sudo -u postgres psql -d luckyred -c "SELECT 1;"

# æ£€æŸ¥ Redis è¿æ¥ï¼ˆå¦‚æœé…ç½®ï¼‰
redis-cli ping

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep 8080
```

---

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ç«‹å³æ‰§è¡Œ

1. **ä¼˜åŒ–æ•°æ®åº“ç´¢å¼•**
   ```bash
   sudo -u postgres psql -d luckyred -f scripts/sql/optimize_indexes.sql
   ```

2. **é…ç½® Redis ç¼“å­˜**ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
   ```bash
   # åœ¨ .env ä¸­æ·»åŠ 
   REDIS_URL=redis://localhost:6379/0
   ```

3. **é…ç½®é˜²ç«å¢™**
   ```bash
   sudo bash scripts/sh/setup_firewall.sh
   ```

### ç›‘æ§å’Œå‘Šè­¦

```bash
# è¿è¡Œæ…¢æŸ¥è¯¢åˆ†æ
python3 scripts/py/analyze_slow_queries.py

# æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡
curl http://localhost:8080/health/metrics
```

---

## ğŸ“ éƒ¨ç½²åæ£€æŸ¥æ¸…å•

### ç«‹å³æ£€æŸ¥ï¼ˆéƒ¨ç½²å 5 åˆ†é’Ÿå†…ï¼‰

- [ ] æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] å‰ç«¯å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] æ— ä¸¥é‡é”™è¯¯æ—¥å¿—

### åŠŸèƒ½æµ‹è¯•ï¼ˆéƒ¨ç½²å 30 åˆ†é’Ÿå†…ï¼‰

- [ ] ä¸»è¦åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] åˆè§„UIæ­£å¸¸å·¥ä½œ
- [ ] ç”¨æˆ·åé¦ˆåŠŸèƒ½å¯ç”¨
- [ ] æ€§èƒ½æŒ‡æ ‡æ­£å¸¸

### æŒç»­ç›‘æ§ï¼ˆéƒ¨ç½²å 1 å°æ—¶å†…ï¼‰

- [ ] ç›‘æ§é”™è¯¯æ—¥å¿—
- [ ] æ£€æŸ¥æ€§èƒ½æŒ‡æ ‡
- [ ] è§‚å¯Ÿç”¨æˆ·ä½¿ç”¨æƒ…å†µ
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ

---

## ğŸ‰ éƒ¨ç½²æˆåŠŸï¼

æ‰€æœ‰ä»£ç å·²æˆåŠŸéƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚è¯·æŒ‰ç…§ä¸Šè¿°æ­¥éª¤éªŒè¯åŠŸèƒ½ï¼Œç¡®ä¿ä¸€åˆ‡æ­£å¸¸è¿è¡Œã€‚

å¦‚æœé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æˆ–è¿è¡Œè¯Šæ–­è„šæœ¬ï¼š
```bash
bash scripts/sh/test-deployment.sh
```

